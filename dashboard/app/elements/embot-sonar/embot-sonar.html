<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->


<dom-module id="embot-sonar">
  <style>
    :host {
      display: flex;
      text-align: center;
      position: relative;
      width: 100%;
      height: 300px;
    }

    :host .robot {
      position: relative;
      flex: 1;
      background-color: grey;
      height: 150px;
      width: 50%;
      border-radius: 50% 100px 100px 50%;
      margin-top: 75px;
    }

    :host .robot .wheel {
      width: 30%;
      height: 20px;
      position: absolute;
      background-color: grey;
      left: 40%;
    }

    :host .robot .wheel:first-of-type {
      top: -20px;
    }

    :host .robot .wheel:nth-of-type(2) {
      bottom: -20px;
    }
    :host .sonar {
      position: relative;
      flex: 2;
      height: 300px;
    }
    :host .sonar div {
      position: absolute;
      height: 10px;
      display: inline-block;
      transform-origin: 50% 100%;
    }

    :host #left {
      left: -10px;
      top: 100px;
     /* transform: rotate(-35deg);*/
    }

    :host #center {
      left: 0;
      top: 145px;
    }

    :host #right {
      left: -10px;
      top: 190px;
      /* transform: rotate(35deg);*/
    }


  </style>
  <template>
    <div class="robot">
      <div class="wheel"></div>
      <div class="wheel"></div>
    </div>
    <div class="sonar">
      <div id="left"></div>
      <div id="center"></div>
      <div id="right"></div>
    </div>
  </template>
</dom-module>

<script>
  (function() {
    Polymer({

      is: 'embot-sonar',

      properties: {
        left: {
          type: Number,
          observer: '_leftChanged'
        },
        center: {
          type: Number,
          observer: '_centerChanged'
        },
        right: {
          type: Number,
          observer: '_rightChanged'
        }
      },
      _leftChanged: function(){
        update(this.$.left, this.left);
      },
      _centerChanged: function(){
        update(this.$.center, this.center);
      },
      _rightChanged: function(){
        update(this.$.right, this.right);
      }
    });

    function update(el, data){
      if (el) {
        el.style.width = data + 'px';
        if (data < 30) {
          el.style.backgroundColor = 'red';
        } else {
          el.style.backgroundColor = 'grey';
        }
      }
    }
  })();
</script>
